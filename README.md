# **Angular + .NET Core + Oracle with Docker**

## **Overview**
This project is a full-stack web application with:
- **Frontend:** Angular (`Web`)
- **Backend:** .NET Core Web API (`WebAPI`)
- **Database:** Oracle SQL (Docker container)
- **ORM:** Dapper for lightweight database operations

The project is containerized using **Docker** and managed via **Docker Compose**.

---

## **1. Setup & Prerequisites**
### **Install the following:**
- [Docker](https://www.docker.com/get-started)
- [.NET SDK](https://dotnet.microsoft.com/en-us/download)
- [Node.js & npm](https://nodejs.org/)
- [Angular CLI](https://angular.io/cli)

---

## **2. Database Setup (Oracle in Docker)**
### **Pull & Run Oracle XE**
```sh
docker pull container-registry.oracle.com/database/express:21.3.0-xe
docker run -d --name oracle-db \
  -p 1521:1521 -p 5500:5500 \
  -e ORACLE_PWD=Oracle123 \
  container-registry.oracle.com/database/express:21.3.0-xe
```

### **Create Users Table**
```sql
CREATE TABLE Users (
    Id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    UserName VARCHAR2(100) NOT NULL,
    Email VARCHAR2(150) UNIQUE NOT NULL,
    Password VARCHAR2(255) NOT NULL
);
```

---

## **3. Backend Setup (.NET Core Web API)**
### **Create & Setup .NET API**
```sh
dotnet new webapi -o WebAPI
cd WebAPI
dotnet add package Dapper
dotnet add package Oracle.ManagedDataAccess.Core
```

### **Add Connection String** (`appsettings.json`)
```json
"ConnectionStrings": {
  "OracleDb": "User Id=SYSTEM;Password=Oracle123;Data Source=localhost:1521/XEPDB1"
}
```

### **Create User Model** (`Models/User.cs`)
```csharp
public class User {
    public int Id { get; set; }
    public string UserName { get; set; }
    public string Email { get; set; }
    public string Password { get; set; }
}
```

### **User Repository using Dapper** (`Repositories/UserRepository.cs`)
```csharp
using System.Data;
using Dapper;
using Oracle.ManagedDataAccess.Client;

public class UserRepository {
    private readonly string _connectionString;
    public UserRepository(IConfiguration configuration) {
        _connectionString = configuration.GetConnectionString("OracleDb");
    }
    public async Task<int> RegisterUser(User user) {
        using IDbConnection db = new OracleConnection(_connectionString);
        string sql = "INSERT INTO Users (UserName, Email, Password) VALUES (:UserName, :Email, :Password) RETURNING Id INTO :Id";
        var parameters = new DynamicParameters();
        parameters.Add("UserName", user.UserName);
        parameters.Add("Email", user.Email);
        parameters.Add("Password", user.Password);
        parameters.Add("Id", dbType: DbType.Int32, direction: ParameterDirection.Output);
        await db.ExecuteAsync(sql, parameters);
        return parameters.Get<int>("Id");
    }
}
```

### **User Controller** (`Controllers/UserController.cs`)
```csharp
[HttpPost("register")]
public async Task<IActionResult> Register(User user) {
    if (string.IsNullOrEmpty(user.UserName) || string.IsNullOrEmpty(user.Email) || string.IsNullOrEmpty(user.Password)) {
        return BadRequest("All fields are required.");
    }
    int userId = await _userRepository.RegisterUser(user);
    return Ok(new { Message = "User registered successfully", UserId = userId });
}
```

### **Run WebAPI**
```sh
dotnet run
```

---

## **4. Frontend Setup (Angular)**
### **Create & Setup Angular App**
```sh
ng new Web
cd Web
npm install axios
```

### **Create Angular Service (`user.service.ts`)**
```typescript
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
@Injectable({ providedIn: 'root' })
export class UserService {
  private apiUrl = 'http://localhost:8080/api/users';
  constructor(private http: HttpClient) {}
  registerUser(user: any) {
    return this.http.post(`${this.apiUrl}/register`, user);
  }
}
```

### **Create Register Component (`register.component.ts`)**
```typescript
import { Component } from '@angular/core';
import { UserService } from '../services/user.service';
@Component({ selector: 'app-register', templateUrl: './register.component.html' })
export class RegisterComponent {
  user = { userName: '', email: '', password: '' };
  constructor(private userService: UserService) {}
  register() {
    this.userService.registerUser(this.user).subscribe(
      () => alert('User registered successfully'),
      () => alert('Error registering user')
    );
  }
}
```

### **Registration Form (`register.component.html`)**
```html
<form (submit)="register()">
  <label>Username:</label>
  <input type="text" [(ngModel)]="user.userName" required />
  <label>Email:</label>
  <input type="email" [(ngModel)]="user.email" required />
  <label>Password:</label>
  <input type="password" [(ngModel)]="user.password" required />
  <button type="submit">Register</button>
</form>
```

### **Run Angular App**
```sh
ng serve --host 0.0.0.0 --port 4200
```

---

## **5. Docker Compose Setup**
### **`docker-compose.yml`**
```yaml
version: '3.8'
services:
  oracle-db:
    image: container-registry.oracle.com/database/express:21.3.0-xe
    ports:
      - "1521:1521"
    environment:
      ORACLE_PWD: Oracle123
  webapi:
    build: ./WebAPI
    ports:
      - "8080:8080"
    depends_on:
      - oracle-db
  web:
    build: ./Web
    ports:
      - "4200:4200"
    depends_on:
      - webapi
```

### **Run Everything in Docker**
```sh
docker-compose up -d --build
```

---

## **6. Test the API**
- **Test in Postman:**
  - **POST** `http://localhost:8080/api/users/register`
  - **Body:**
    ```json
    { "userName": "testuser", "email": "test@example.com", "password": "password123" }
    ```
- **Test Angular UI:** Open `http://localhost:4200`

---

## **Next Steps**
- Implement JWT authentication
- Hash passwords before saving
- Build user login & profile update APIs

---
ðŸš€ **Project is now fully set up!** Let me know if you need improvements.

